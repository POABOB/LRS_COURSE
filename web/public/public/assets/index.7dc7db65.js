import{a as I,S as v,c as V,o as h,b as A,w as p,d as m,v as y,e as t,f as w,g as S,r as x,T as k,h as d,i as T,j as b,k as N,l as P,m as E,n as D,p as j,q as O,s as q,t as R,u as G,x as U,y as z,V as J,G as H}from"./vendor.d458375c.js";const K=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function a(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerpolicy&&(n.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?n.credentials="include":r.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(r){if(r.ep)return;r.ep=!0;const n=a(r);fetch(r.href,n)}};K();const $={user:o=>o.user},f=I.create({baseURL:"http://lrs.im.ncue.edu.tw:3000",timeout:1e4});f.interceptors.request.use(o=>{const{user:e}=JSON.parse(JSON.stringify(g.state.user));return e.token!==null&&(o.headers.Authorization="Bearer "+e.token),o},o=>(console.log(o),Promise.reject(o)));f.interceptors.response.use(o=>{const e=o.data;return e.status!==200?(v.fire({icon:"error",title:e.message||"Error",showConfirmButton:!0,timer:1500}),(e.status===508||e.status===512||e.status===514)&&v.fire({title:"Token\u904E\u671F\uFF0C\u8ACB\u91CD\u65B0\u767B\u5165\uFF01",showDenyButton:!0,showCancelButton:!0,confirmButtonText:"\u91CD\u65B0\u767B\u5165",cancelButtonText:"\u53D6\u6D88",type:"info"}).then(a=>{a.isConfirmed&&g.dispatch("user/resetState").then(()=>{location.reload()})}),Promise.reject(new Error(e.message||"Error"))):e},o=>(console.log("err"+o),v.fire({icon:"error",title:o.message,showConfirmButton:!0,timer:5*1e3}),Promise.reject(o)));function F(o){return f({url:"/api/login",method:"post",data:o})}function W(o){return f({url:"/api/password/change",method:"post",data:o})}function Q(){return f({url:"/api/logout",method:"get"})}const M=()=>{const o=JSON.parse(localStorage.getItem("NCUE_IM_user"));return o!==null&&o.expires_at>Date.now()?{user:o}:{user:{name:"",email:"",id:0,right:"",expires_at:0,token:null}}},X=M(),Y={adminLogin({commit:o},e){const{account:a,password:s}=e;return new Promise((r,n)=>{F({account:a.trim(),password:s}).then(i=>{if(i.status===200){let{data:c}=i;c.expires_at=Date.now()+3600*1e3*24,c.account=a,c.right="admin",o("LOGIN",c),r()}else n("\u5E33\u865F\u5BC6\u78BC\u932F\u8AA4")}).catch(i=>{n(i)})})},googleLogin({commit:o},e){o("LOGIN",e)},resetState({commit:o}){o("RESET_STATE")}},Z={LOGIN(o,e){o.user=e,localStorage.setItem("NCUE_IM_user",JSON.stringify(e))},RESET_STATE(o){Object.assign(o,M()),localStorage.setItem("NCUE_IM_user",JSON.stringify(M()))}};var ee={namespaced:!0,state:X,mutations:Z,actions:Y};const te=V({modules:{user:ee},getters:$});var g=te;const oe="modulepreload",C={},se="/public/",u=function(e,a){return!a||a.length===0?e():Promise.all(a.map(s=>{if(s=`${se}${s}`,s in C)return;C[s]=!0;const r=s.endsWith(".css"),n=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${n}`))return;const i=document.createElement("link");if(i.rel=r?"stylesheet":oe,r||(i.as="script",i.crossOrigin=""),i.href=s,document.head.appendChild(i),r)return new Promise((c,_)=>{i.addEventListener("load",c),i.addEventListener("error",_)})})).then(()=>e())};var L=(o,e)=>{const a=o.__vccOpts||o;for(const[s,r]of e)a[s]=r;return a};const re={name:"Modal",props:["isModalOpen"],setup(o,{emit:e}){return{closeModal:()=>{e("closeModal")}}}},ne={class:"flex justify-between"},ae={class:"mb-2 text-lg font-semibold text-gray-700"},ie=d(" \u5099\u8A3B "),le=t("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",role:"img","aria-hidden":"true"},[t("path",{d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd","fill-rule":"evenodd"})],-1),ue=[le],ce={class:"mt-4 mb-6"},de=t("div",{class:"mt-4 text-sm mb-4"},[t("span",{class:"text-gray-700"}," \u6703\u54E1\u985E\u578B "),t("div",{class:"mt-2"},[t("label",{class:"inline-flex items-center text-gray-600"},[t("input",{type:"radio",class:"text-purple-600 form-radio focus:border-purple-400 focus:outline-none focus:shadow-outline-purple",name:"accountType",value:"personal"}),t("span",{class:"ml-2"},"Personal")]),t("label",{class:"inline-flex items-center ml-6 text-gray-600"},[t("input",{type:"radio",class:"text-purple-600 form-radio focus:border-purple-400 focus:outline-none focus:shadow-outline-purple",name:"accountType",value:"busines"}),t("span",{class:"ml-2"},"Business")])])],-1),me=t("label",{class:"block text-sm mb-4"},[t("span",{class:"text-gray-700"},"\u72C0\u614B\u66F4\u65B0"),t("input",{class:"block w-full mt-1 text-sm focus:border-purple-400 focus:outline-none focus:shadow-outline-purple",placeholder:"\u8F38\u5165"})],-1),pe=t("p",{class:"text-sm text-gray-700"},[d(" \u66FF\u8EAB\u80FD\u529B:\u900F\u904E\u62F3\u982D\u6BC6\u6253\u6216\u78B0\u89F8\u5C0D\u5C0D\u65B9\u7684\u610F\u8B58\u9032\u884C\u653B\u64CA"),t("br"),d("(\u4F8B\u5982:\u7CBE\u795E\u653B\u64CA\uFF0C\u7CBE\u795E\u5D29\u6F70\uFF0C\u9032\u5165\u5047\u6B7B\u72C0\u614B)"),t("br"),t("br"),d("\u7834\u58DE\u529B:C"),t("br"),d("\u901F\u5EA6:A"),t("br"),d("\u7CBE\u78BA\u6027:B ")],-1),fe={class:"flex flex-col items-center justify-end px-6 py-3 -mx-6 -mb-4 space-y-4 sm:space-y-0 sm:space-x-6 sm:flex-row bg-gray-50"},he=t("button",{class:"w-full px-5 py-3 text-sm font-medium leading-5 text-white transition-colors duration-150 bg-black border border-transparent rounded-lg sm:w-auto sm:px-4 sm:py-2 focus:outline-none"}," \u66F4\u65B0 ",-1);function ge(o,e,a,s,r,n){return h(),A(k,{name:"modal-animation","enter-active-class":"transition ease-out duration-150","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:p(()=>[m(t("div",{onClick:e[3]||(e[3]=(...i)=>s.closeModal&&s.closeModal(...i)),tabindex:"0",class:"fixed inset-0 flex items-end bg-black z-30 bg-opacity-50 sm:items-center sm:justify-center overflow-auto"},[w(k,{name:"modal-inner","enter-active-class":"transition ease-out duration-150","enter-from-class":"opacity-0 transform translate-y-1/2","enter-to-class":"opacity-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100","leave-to-class":"opacity-0  transform translate-y-1/2"},{default:p(()=>[m(t("div",{onClick:e[2]||(e[2]=S(()=>{},["stop"])),class:"w-full px-6 py-4 overflow-auto bg-white rounded-t-lg sm:rounded-lg sm:m-auto sm:m-4 sm:max-w-xl",role:"dialog",id:"modal"},[t("header",ne,[t("p",ae,[x(o.$slots,"header",{},()=>[ie])]),t("button",{class:"inline-flex items-center justify-center w-6 h-6 text-gray-400 transition-colors duration-150 rounded hover: hover:text-gray-700","aria-label":"close",onClick:e[0]||(e[0]=(...i)=>s.closeModal&&s.closeModal(...i))},ue)]),t("div",ce,[x(o.$slots,"body",{},()=>[de,me,pe])]),t("footer",fe,[x(o.$slots,"footer",{},()=>[t("button",{onClick:e[1]||(e[1]=(...i)=>s.closeModal&&s.closeModal(...i)),class:"w-full px-5 py-3 text-sm font-medium leading-5 text-white text-gray-700 transition-colors duration-150 border border-gray-300 rounded-lg sm:px-4 sm:py-2 sm:w-auto active:bg-transparent hover:border-gray-500 focus:border-gray-500 active:text-gray-500 focus:outline-none focus:shadow-outline-gray"}," \u53D6\u6D88 "),he])])],512),[[y,a.isModalOpen]])]),_:3})],512),[[y,a.isModalOpen]])]),_:3})}var _e=L(re,[["render",ge]]);const ve={data(){return{isSideMenuOpen:!1,isProfileMenuOpen:!1,loading:!1,data:{account:"",password:"",passconf:""}}},created(){const o=JSON.parse(JSON.stringify(this.$store.state.user.user));this.data.account=o.account},methods:{toggleSideMenu(){this.isSideMenuOpen=!this.isSideMenuOpen},toggleProfileMenu(){this.isProfileMenuOpen=!this.isProfileMenuOpen},closeProfileMenu(){this.isProfileMenuOpen=!1},logout(){this.loading=!0,Q().then(()=>{this.$swal({icon:"success",title:"\u767B\u51FA\u6210\u529F!",showConfirmButton:!0,timer:1e3}),this.$store.dispatch("user/resetState"),this.$router.push({name:"Login"}),this.loading=!1}).catch(()=>{this.loading=!1})},updatePassword(){if(this.loading===!0)this.$swal({icon:"error",title:"\u8CC7\u6599\u63D0\u4EA4\u4E2D\uFF0C\u8ACB\u52FF\u91CD\u8907\u63D0\u4EA4!",showConfirmButton:!0,timer:3e3});else{const o=document.getElementById("passwordForm");o[0].checkValidity()?this.data.password!==this.data.passconf?this.$swal({icon:"error",title:"\u5BC6\u78BC\u78BA\u8A8D\u9700\u4E00\u81F4!!",showConfirmButton:!0,timer:1e3}):(this.loading=!0,W(this.data).then(e=>{e.status===200?this.$swal({icon:"success",title:"\u5BC6\u78BC\u4FEE\u6539\u6210\u529F!",showConfirmButton:!0,timer:1e3}):this.$swal({icon:"error",title:e.message,showConfirmButton:!0,timer:1e3}),this.loading=!1,this.data.password="",this.data.passconf="",this.toggleModal()}).catch(()=>{this.loading=!1})):o[0].reportValidity()}}},components:{Modal:_e},setup(){const o=T(!1);return{isModalOpen:o,toggleModal:()=>{o.value=!o.value},closeModal:()=>{o.value=!1}}}},xe={class:"fixed flex-shrink-0 shadow w-full mt-16 overflow-x-auto bg-white","x-transition:enter":"transition ease-in-out duration-150","x-transition:enter-start":"opacity-0 transform -translate-y-20","x-transition:enter-end":"opacity-100","x-transition:leave":"transition ease-in-out duration-150","x-transition:leave-start":"opacity-100","x-transition:leave-end":"opacity-0 transform -translate-y-20"},ye=q('<div class="py-4 text-center text-gray-500"><ul class="mt-6"><li class="relative inline px-6 py-3"><a class="inline-flex items-center text-sm font-semibold transition-colors duration-150 hover:text-gray-800" href=""><svg class="w-5 h-5" aria-hidden="true" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" stroke="currentColor"><path d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path></svg><span class="ml-4">Dashboard</span></a></li><li class="relative inline px-6 py-3"><a class="inline-flex items-center text-sm font-semibold transition-colors duration-150 hover:text-gray-800" href=""><svg class="w-5 h-5" aria-hidden="true" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" stroke="currentColor"><path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg><span class="ml-4">\u7533\u8ACB\u8868</span></a></li><li class="relative inline px-6 py-3"><a class="inline-flex items-center text-sm font-semibold transition-colors duration-150 hover:text-gray-800" href=""><svg class="w-5 h-5" aria-hidden="true" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" stroke="currentColor"><path d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg><span class="ml-4">\u8A2D\u5099</span></a></li><li class="relative inline px-6 py-3"><a class="inline-flex items-center text-sm font-semibold text-gray-800 transition-colors duration-150 hover:text-gray-800" href=""><svg class="w-5 h-5" aria-hidden="true" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" stroke="currentColor"><path d="M4 6h16M4 10h16M4 14h16M4 18h16"></path></svg><span class="ml-4">\u5165\u5E33\u8868</span></a></li></ul></div>',1),we=[ye],be={class:"flex flex-col flex-1 w-full"},Me={class:"z-10 py-4 bg-white"},ke={class:"container flex items-center justify-between h-full px-6 mx-auto"},Pe=t("h4",null,"\u5B78\u751F\u7BA1\u7406\u5F8C\u53F0",-1),Ee={class:"flex items-center flex-shrink-0 space-x-6"},Oe={class:"relative"},Ce=t("img",{class:"object-cover w-8 h-8 rounded-full",src:"https://source.boringavatars.com/beam",alt:"","aria-hidden":"true"},null,-1),Ae=[Ce],Se=t("div",{class:"inline-flex items-center w-full px-2 py-1 text-sm font-semibold transition-colors duration-150 rounded-md hover:bg-gray-100 hover:text-gray-800 cursor-pointer"},[t("svg",{class:"w-4 h-4 mr-3","aria-hidden":"true",fill:"none","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})]),t("span",null,"Profile")],-1),Le=[Se],Be=t("div",{class:"inline-flex items-center w-full px-2 py-1 text-sm font-semibold transition-colors duration-150 rounded-md hover:bg-gray-100 hover:text-gray-800 cursor-pointer"},[t("svg",{class:"w-4 h-4 mr-3","aria-hidden":"true",fill:"none","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{d:"M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"})]),t("span",null,"Log out")],-1),Ie=[Be],Ve=t("p",null,"Profile",-1),Te={class:"mb-5"},Ne=t("label",{for:"password",class:"block mb-2 text-sm text-gray-600 dark:text-gray-400"},"\u5BC6\u78BC",-1),De={class:"mb-6"},je=t("label",{for:"passconf",class:"block mb-2 text-sm text-gray-600 dark:text-gray-400"},"\u5BC6\u78BC\u78BA\u8A8D",-1);function qe(o,e,a,s,r,n){const i=b("router-view"),c=b("Modal"),_=N("click-away");return h(),P("div",null,[t("div",{class:j(["flex h-screen bg-gray-50",{"overflow-hidden":r.isSideMenuOpen}])},[m(t("nav",xe,we,512),[[y,r.isSideMenuOpen]]),t("div",be,[t("header",Me,[t("div",ke,[Pe,t("ul",Ee,[t("li",Oe,[t("button",{class:"align-middle rounded-full focus:outline-none",onClick:e[0]||(e[0]=(...l)=>n.toggleProfileMenu&&n.toggleProfileMenu(...l)),onKeydown:e[1]||(e[1]=E((...l)=>n.closeProfileMenu&&n.closeProfileMenu(...l),["escape"])),"aria-label":"Account","aria-haspopup":"true"},Ae,32),r.isProfileMenuOpen?m((h(),P("ul",{key:0,"x-transition:leave":"transition ease-in duration-150","x-transition:leave-start":"opacity-100","x-transition:leave-end":"opacity-0",onKeydown:e[4]||(e[4]=E((...l)=>n.closeProfileMenu&&n.closeProfileMenu(...l),["escape"])),class:"absolute right-0 w-56 p-2 mt-2 space-y-2 text-gray-600 bg-white border border-gray-100 rounded-md shadow-md","aria-label":"submenu"},[t("li",{class:"flex",onClick:e[2]||(e[2]=(...l)=>s.toggleModal&&s.toggleModal(...l))},Le),t("li",{class:"flex",onClick:e[3]||(e[3]=(...l)=>n.logout&&n.logout(...l))},Ie)],32)),[[_,n.closeProfileMenu]]):D("",!0)])])])]),w(i)])],2),w(c,{onCloseModal:s.closeModal,isModalOpen:s.isModalOpen},{header:p(()=>[Ve]),body:p(()=>[t("form",{class:"mb-4",id:"passwordForm",onSubmit:e[7]||(e[7]=S((...l)=>n.updatePassword&&n.updatePassword(...l),["prevent"]))},[t("div",Te,[Ne,m(t("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>r.data.password=l),id:"password",name:"password",type:"password",required:"true",maxlength:"128",minlength:"4",class:"appearance-none rounded relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"\u8ACB\u8F38\u5165\u65B0\u5BC6\u78BC..."},null,512),[[O,r.data.password]])]),t("div",De,[je,m(t("input",{"onUpdate:modelValue":e[6]||(e[6]=l=>r.data.passconf=l),id:"passconf",name:"passconf",type:"password",required:"true",maxlength:"128",minlength:"4",class:"appearance-none rounded relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"\u8ACB\u8F38\u5165\u518D\u6B21\u65B0\u5BC6\u78BC..."},null,512),[[O,r.data.passconf]])])],32)]),footer:p(()=>[t("button",{onClick:e[8]||(e[8]=(...l)=>s.closeModal&&s.closeModal(...l)),class:"w-full px-5 py-3 text-sm font-medium leading-5 text-black text-gray-700 transition-colors duration-150 border border-gray-300 rounded-lg sm:px-4 sm:py-2 sm:w-auto active:bg-transparent hover:border-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 focus:shadow-outline-gray"}," \u53D6\u6D88 "),t("button",{onClick:e[9]||(e[9]=(...l)=>n.updatePassword&&n.updatePassword(...l)),class:"w-full px-5 py-3 text-sm font-medium leading-5 text-white transition-colors duration-150 bg-black border border-transparent rounded-lg sm:w-auto sm:px-4 sm:py-2 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"}," \u66F4\u65B0 ")]),_:1},8,["onCloseModal","isModalOpen"])])}var Re=L(ve,[["render",qe]]);const Ge=[{path:"/",name:"Home",component:()=>u(()=>import("./Home.790e4c8a.js"),["assets/Home.790e4c8a.js","assets/vendor.d458375c.js","assets/student.60435114.js"])},{path:"/google",name:"Google",component:()=>u(()=>import("./Google.ceb802db.js"),["assets/Google.ceb802db.js","assets/vendor.d458375c.js"])},{path:"/course/list",name:"Course_List",component:()=>u(()=>import("./List.994bd86b.js"),["assets/List.994bd86b.js","assets/vendor.d458375c.js"]),meta:{requireAuth:!0}},{path:"/course/A",name:"Course_A",component:()=>u(()=>import("./A.7a113b84.js"),["assets/A.7a113b84.js","assets/vendor.d458375c.js"]),meta:{requireAuth:!0}},{path:"/course/B",name:"Course_B",component:()=>u(()=>import("./B.099dbe32.js"),["assets/B.099dbe32.js","assets/vendor.d458375c.js"]),meta:{requireAuth:!0}},{path:"/course/C",name:"Course_C",component:()=>u(()=>import("./C.acf73197.js"),["assets/C.acf73197.js","assets/vendor.d458375c.js"]),meta:{requireAuth:!0}},{path:"/course/D",name:"Course_D",component:()=>u(()=>import("./D.ffade700.js"),["assets/D.ffade700.js","assets/vendor.d458375c.js"]),meta:{requireAuth:!0}},{path:"/login",name:"Login",component:()=>u(()=>import("./Login.9579d82a.js"),["assets/Login.9579d82a.js","assets/vendor.d458375c.js"])},{path:"/admin",component:Re,meta:{requireAdminAuth:!0},children:[{path:"/admin",name:"Admin_Home",component:()=>u(()=>import("./Home.45f64f02.js"),["assets/Home.45f64f02.js","assets/student.60435114.js","assets/vendor.d458375c.js"])}]}],B=R({history:G(),routes:Ge});B.beforeEach((o,e,a)=>{const{user:s}=JSON.parse(JSON.stringify(g.state.user));o.meta.requireAuth===!0&&(!s.token||s.right!=="student")?(console.log(1),a({name:"Home"})):o.meta.requireAdminAuth===!0&&(!s.token||s.right!=="admin"||s.expires_at<Date.now())?a({name:"Login"}):a()});const Ue={setup(o){return(e,a)=>{const s=b("router-view");return h(),A(s)}}};const ze={clientId:"696986273196-ete7bbkt6jkuq761fpeuvo17mfh8jbke.apps.googleusercontent.com",scope:"profile email",prompt:"consent",fetch_basic_profile:!0};U(Ue).use(z).use(J).use(g).use(B).use(H,ze).mount("#app");export{_e as M,L as _,f as s};
